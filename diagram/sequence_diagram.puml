@startuml
title Sequence Diagram: Update Status Ruangan Realtime

' Pengaturan Tampilan
skinparam responseMessageBelowArrow true
skinparam style strictuml
autonumber

' Definisi Lifeline (Objek yang berinteraksi)
participant "ESP32 Sensor" as ESP32
participant "API Backend\n(Elysia)" as API
participant "Room Controller" as Ctrl
database "Database\n(Prisma/SQLite)" as DB

' == Mulai Proses Update ==

' 1. ESP32 mengirim data
ESP32 -> API: POST /update-status\n(JSON: {room_id: "R-101", is_moving: true})
activate API

' 2. API (Elysia) meneruskan ke Controller yang tepat
API -> Ctrl: Invoke updateStatusHandler(body)
activate Ctrl

' 3. Controller melakukan validasi dan logika bisnis
Ctrl -> Ctrl: Validate Input Data

' 4. Controller meminta Database untuk update data
Ctrl -> DB: prisma.room.update({ \n  where: {id: "R-101"}, \n  data: {status: "OCCUPIED"} \n})
activate DB

' 5. Database mengembalikan hasil
DB --> Ctrl: Return Updated Room Object
deactivate DB

' 6. Controller mengembalikan respon ke API framework
Ctrl --> API: Return JSON Result
deactivate Ctrl

' 7. API mengirim respon HTTP balik ke ESP32
API --> ESP32: HTTP 200 OK\n(JSON: {success: true, message: "Updated"})
deactivate API

@enduml